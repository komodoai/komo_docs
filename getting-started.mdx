---
title: "Getting Started"
---

Komodo AI can run your jobs on various backends. The choice of backend is yours - we strive to provide the same seamless experience regardless of your choice.


<Steps>
  <Step title="Install Komodo CLI">
    ```bash
    pip install komo
    ```
  </Step>
  <Step title="Register a new account">
    ```bash
    komo register
    ```
  </Step>
  <Step title="Create the Komodo API key">
    The Komodo API key is used to authenticate to the Komodo API.
    
    ```bash
    komo api-key create
    ```
  </Step>
  <Step title="Setup your compute infrastructure">
    There are several different types of compute services that are supported. Follow the instructions for each type of compute service you'd like to use.
    <Accordion title="Local">
        To run jobs locally, you just need to make sure you have Docker [installed](https://docs.docker.com/engine/install/) and running.
    </Accordion>
    <Accordion title="AWS">
        First, make sure you have the following installed:

        - [Docker](https://docs.docker.com/engine/install/)
        - [Terraform](https://developer.hashicorp.com/terraform/tutorials/aws-get-started/install-cli)
        - [jq](https://jqlang.github.io/jq/download/)
        - [AWS CLI](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html)

        Then, setup your base environment:

        ```bash
        komo compute create -t aws -n my-cluster --aws-profile <your aws profile (eg. default)> --aws-region your-region
        ```

        <Info>We only support running this command for one region at the moment. If you try to run this for a second region,
        the first will get deleted. If you need to use multiple regions, let us know and we can prioritize this.</Info>

        Next, for *each* instance type you want to use, run the following:

        <Note>Don't worry, this won't launch any instances of this type, this is simply just to get your environment ready to launch these instances.</Note>

        ```bash
        komo compute add-aws-instance -t instance-type -n instance-type-alias --volume-size 100
        ```

        <Note>`--volume-size` is the size of the EBS volume that will be attached to the instance upon launching.</Note>
        <Note>You can set `-n` to whatever you like, this is just the name you will use to refer to this instance type.
        For example, for a p4d.24xlarge, you might name it `p4-24xl`, `a100x8`, or even just `gpu-large`.</Note>
    </Accordion>
    <Accordion title="Kubernetes">
        <Note>We don't recommend using Kubernetes if you need support for autoscaling AND multi-node distributed training.
        This is because we use [Volcano](https://volcano.sh/en/) as our gang scheduler for multi-node jobs, which doesn't
        work well with autoscalers.</Note>

        Follow these steps to get your Kubernetes cluster ready for Komodo:

        <Tip>
            If you need help with the steps below, reach out to someone on the Platform
            team in your organization or let us know and we'll be happy to work with you
            to get this set up!
        </Tip>

        <Accordion title="Install Volcano" icon="volcano">
            Komodo uses [Volcano](https://volcano.sh/en/) to schedule workloads on your Kubernetes cluster.

            Install Volcano by following the appropriate instructions in the [Volcano README](https://github.com/volcano-sh/volcano#readme).
        </Accordion>

        <Accordion title="Create Komodo Resources" icon="dragon">
            Komodo uses isolated resources to schedule workloads on your cluster. In this section we will configure these resources.

            **Create Komodo Cluster Role**

            ```bash
            kubectl apply -f https://raw.githubusercontent.com/komodoai/komo_cli/main/komodo_cli/terraform/komodo_manifests/files/cluster-role.yaml
            ```

            **Create Komodo Service Account**

            ```bash
            kubectl apply -f https://raw.githubusercontent.com/komodoai/komo_cli/main/komodo_cli/terraform/komodo_manifests/files/service-account.yaml
            ```

            **Link the Komodo Service Account to the Komodo Cluster Role**

            ```bash
            kubectl apply -f https://raw.githubusercontent.com/komodoai/komo_cli/main/komodo_cli/terraform/komodo_manifests/files/cluster-role-binding.yaml
            ```

            **Create a Komodo Service Account Token**

            ```bash
            kubectl apply -f https://raw.githubusercontent.com/komodoai/komo_cli/main/komodo_cli/terraform/komodo_manifests/files/service-account-token.yaml
            ```
        </Accordion>
        <Accordion title="Obtain and store cluster details" icon="gear">
            To prepare for the next step, you'll need to obtain the URL of your Kubernetes cluster API server and a token to communicate with the cluster.

            <Note>
            This token belongs to the Service Account we created in the Kubernetes cluster
            configuration step.
            </Note>

            First set the `CLUSTER_NAME` environment variable to the name of your cluster.

            <Accordion title="How to get cluster name?">
            Try `kubectl config view | grep -m 1 "name" | awk '{ print $2 }'` command or ask your platform engineer.
            </Accordion>

            ```bash
            export CLUSTER_NAME="my-cluster-name"
            ```

            ##### **host**

            The value for `host` can be obtained in the following way

            ```bash
            kubectl cluster-info $CLUSTER_NAME | grep "control plane" | awk '{ print $NF }'
            ```

            ##### **bearer_token**

            The value for the `bearer_token` can be obtained using the following steps.

            ```bash
            echo "Obtaining the Service Account token for cluster $CLUSTER_NAME"
            echo ""
            TOKEN=$(kubectl get secret komodo-runner-secret --namespace default -o jsonpath='{.data.token}' | base64 -d)
            echo "$TOKEN"
            ```
        </Accordion>
    </Accordion>
  </Step>
  <Step title="Create Komodo backends">
    Now that you've setup your backend infrastructure, you now just need to create a Komodo backend to point to your infrastructure.
    A Komodo backend defines what compute service (eg. local, AWS) you want to use for a given job.
    For each backend, you will define 1 or more resources, which specify what type of machine you want to use for a given job
    
    <Accordion title="Local">
      Simply just run:

      ```bash
      komo backend create -t local -n local
      ```

      <Note>You can specify whatever name you want for `-n`.</Note>

      This is all you need to do to set up the local backend. No need to create any resources.
    </Accordion>

    <Accordion title="AWS">
      First, you'll need to create an IAM role that Komodo can use to launch jobs. From the IAM
      section in the AWS console, create a new User with the following permissions:

      - `AWSBatchFullAccess`
      - `DescribeInstanceTypes`
      - `ECSExecuteCommand`

      Make sure to download the credentials for this user and store them somewhere safe.

      Next, you can create the backend like so:

      ```bash
      komo backend create -t aws -n aws
      ```

      <Note>You can set `-n` to whatever name you like. This is the name of backend that will be referenced in your project config file and when running jobs.</Note>

      This command will prompt you to enter the following information:
      - **access_key_id**: The access key ID from the credentials you downloaded for the new user you created
      - **secret_access_key**: The secrety access key from the credentials you downloaded for the new user you created
      - **docker_repo**: This is an ECR repo called `komodo-overlays` that was created when running `komo compute create`. You can find this by running the `komo compute list` command.
      - **ssh-key**: This is the path to an SSH key that was created when running `komo compute create`. You can find this by running the `komo compute list` command.
      - **basion-ip-address**: This is the IP address of a small (t2.micro) instance that is created as a proxy server to allow you to ssh into your jobs/machines. You can find this by running the `komo compute list` command.

      And finally, for each instance type you set up using `komo compute add-aws-instance`, create a resource like so:
      
      ```bash
      komo backend add-resource -b aws -n p4-24xl
      ```

      This will prompt you to enter the following information:
      - **instance_type**: The instance type you specified to `komo compute add-aws-instance`
      - **aws_batch_queue**: You can find this by running `komo compute list` and looking in the `queue_arns` section. Enter the last part of the queue related to this instance. In this example, that would be `komodo-my-cluster-p4-24xl-queue`
    </Accordion>

    <Accordion title="Kubernetes">
      Create a Kubernetes backend as follows:

      ```bash
      komo backend create -t kubernetes -n my-cluster
      ```

      It will prompt you to enter some of the information you got from the previous step.

      Next, create a resource for each machine type you want to use:

      ```bash
      komo backend add-resource -b my-cluster -n gpu-large
      ```

      It will prompt you to enter the hardware requirements for this resource (ie. how many cpus/gpus/mem you want).
      It will prompt you to (optionally) enter an instance type. If entered, this will set the `node.kubernetes.io/instance-type` key of the pod capabilities accordingly for jobs/machines you create with this resource.
    </Accordion>
  </Step>
  <Step title="Initialize a Komodo project in your repository">
    Initialize a new Komodo project by running the following command inside your project directory:
    
    ```bash
    komo init project
    ```
    
    This will create a template project configuration in  `.komo/project.yaml`. This will set up
    different configurations for the different backends you created earlier.
    Edit this file to fit your needs.

    <Tip>You should be able to use this without any changes, as long as you have a requirements.txt file in your
    project directory that has all the requirements needed to run your code.</Tip>
  </Step>
  <Step title="Run Your First Komodo Job">
    You are now ready to run your first job! 
    
    ```bash
    komo run -b aws -r p4-24xl echo "Hello World!"
    ```
    
    [Find full details on this command here.](./komo-cli-reference/command/run)
  </Step>
</Steps>
